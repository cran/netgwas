context("buildMap")

test_that("buildMap construction method works ", 
  {
    data(CviCol)
    M1 <- netmap(CviCol, method="npn", cross= "inbred")
    bm <- buildMap(M1, opt.index=5)	 
    #dput(bm$map$markers)
	
	  expect_equal( bm$map$markers, structure(1:90, .Label = c("c1_00593", "c1_02212", "c1_02992", 
"c1_04176", "c1_05593", "c1_08385", "c1_09782", "c1_11160", "c1_12295", 
"c1_13869", "c1_13926", "c1_15634", "c1_16875", "c1_18433", "c1_19478", 
"c1_20384", "c1_22181", "c1_23381", "c1_24795", "c1_25698", "c1_26993", 
"c1_28454", "c1_28667", "c1_29898", "c2_00593", "c2_02365", "c2_03041", 
"c2_04263", "c2_06280", "c2_07650", "c2_10250", "c2_11457", "c2_12435", 
"c2_13472", "c2_15252", "c2_16837", "c2_17606", "c2_18753", "c3_00580", 
"c3_00885", "c3_01901", "c3_02968", "c3_04141", "c3_05141", "c3_06631", 
"c3_08042", "c3_09748", "c3_10996", "c3_11192", "c3_12647", "c3_15117", 
"c3_16677", "c3_18180", "c3_20729", "c3_22147", "c4_00012", "c4_00641", 
"c4_02133", "c4_03833", "c4_04877", "c4_05850", "c4_06923", "c4_07549", 
"c4_07740", "c4_08930", "c4_10609", "c4_11878", "c4_13171", "c4_14819", 
"c4_15765", "c4_17684", "c5_00576", "c5_01587", "c5_02900", "c5_04011", 
"c5_05319", "c5_06820", "c5_07442", "c5_08563", "c5_10428", "c5_13614", 
"c5_14766", "c5_17570", "c5_19316", "c5_20318", "c5_21319", "c5_22415", 
"c5_23116", "c5_24997", "c5_26671"), class = "factor")  )  
   })
